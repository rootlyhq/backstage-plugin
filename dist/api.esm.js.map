{"version":3,"file":"api.esm.js","sources":["../src/api.ts"],"sourcesContent":["import {\n    ConfigApi,\n    IdentityApi,\n    DiscoveryApi,\n  } from '@backstage/core-plugin-api';\nimport { RootlyApi } from '@rootly/backstage-plugin-common';\n\nexport const useRootlyClient = ({ config, discovery, identify, organizationId }: { config: ConfigApi, discovery: DiscoveryApi, identify: IdentityApi, organizationId?: string }) => {\n  const configKeys = config.getConfig('rootly').keys();\n\n  let apiProxyPath = config.getOptionalString(`rootly.${configKeys.at(0)}.proxyPath`);\n\n  if (organizationId) {\n    apiProxyPath = config.getOptionalString(`rootly.${organizationId}.proxyPath`)\n  } else if (configKeys.length > 1) {\n    let defaultOrgId = config.getConfig('rootly').keys().at(0)\n    for (const orgId of config.getConfig('rootly').keys()) {\n      if (config.getOptionalBoolean(`rootly.${orgId}.isDefault`)) {\n        defaultOrgId = orgId\n        break;\n      }\n    }\n    apiProxyPath = config.getOptionalString(`rootly.${defaultOrgId}.proxyPath`)\n  }\n\n  const client = new RootlyApi({\n    apiProxyUrl: discovery.getBaseUrl('proxy'),\n    apiProxyPath: apiProxyPath,\n    apiToken: identify.getCredentials(),\n  });\n  return client;\n}"],"names":[],"mappings":";;AAOO,MAAM,kBAAkB,CAAC,EAAE,QAAQ,SAAW,EAAA,QAAA,EAAU,gBAAqH,KAAA;AAClL,EAAA,MAAM,UAAa,GAAA,MAAA,CAAO,SAAU,CAAA,QAAQ,EAAE,IAAK,EAAA,CAAA;AAEnD,EAAI,IAAA,YAAA,GAAe,OAAO,iBAAkB,CAAA,CAAA,OAAA,EAAU,WAAW,EAAG,CAAA,CAAC,CAAC,CAAY,UAAA,CAAA,CAAA,CAAA;AAElF,EAAA,IAAI,cAAgB,EAAA;AAClB,IAAA,YAAA,GAAe,MAAO,CAAA,iBAAA,CAAkB,CAAU,OAAA,EAAA,cAAc,CAAY,UAAA,CAAA,CAAA,CAAA;AAAA,GAC9E,MAAA,IAAW,UAAW,CAAA,MAAA,GAAS,CAAG,EAAA;AAChC,IAAI,IAAA,YAAA,GAAe,OAAO,SAAU,CAAA,QAAQ,EAAE,IAAK,EAAA,CAAE,GAAG,CAAC,CAAA,CAAA;AACzD,IAAA,KAAA,MAAW,SAAS,MAAO,CAAA,SAAA,CAAU,QAAQ,CAAA,CAAE,MAAQ,EAAA;AACrD,MAAA,IAAI,MAAO,CAAA,kBAAA,CAAmB,CAAU,OAAA,EAAA,KAAK,YAAY,CAAG,EAAA;AAC1D,QAAe,YAAA,GAAA,KAAA,CAAA;AACf,QAAA,MAAA;AAAA,OACF;AAAA,KACF;AACA,IAAA,YAAA,GAAe,MAAO,CAAA,iBAAA,CAAkB,CAAU,OAAA,EAAA,YAAY,CAAY,UAAA,CAAA,CAAA,CAAA;AAAA,GAC5E;AAEA,EAAM,MAAA,MAAA,GAAS,IAAI,SAAU,CAAA;AAAA,IAC3B,WAAA,EAAa,SAAU,CAAA,UAAA,CAAW,OAAO,CAAA;AAAA,IACzC,YAAA;AAAA,IACA,QAAA,EAAU,SAAS,cAAe,EAAA;AAAA,GACnC,CAAA,CAAA;AACD,EAAO,OAAA,MAAA,CAAA;AACT;;;;"}